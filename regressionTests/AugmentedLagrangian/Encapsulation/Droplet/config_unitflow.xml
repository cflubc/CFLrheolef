<?xml version="1.0" encoding="UTF-8"?>
<data>
    <problem>AugLag_DropletEncapsulation</problem>

    <FEfields>
        <pspace>P1</pspace>
        <vspace>P2</vspace>
    </FEfields>

    <PhysicalParameters>
        <Bn>
           <domain_names>droplet fluid</domain_names>
           <values>1 1</values>
        </Bn>
        <Viscosity>
          <domain_names>droplet fluid</domain_names>
          <values>.1 1</values>
        </Viscosity>
    </PhysicalParameters>

   <Augmentation_coef>10</Augmentation_coef>

   <unitflow_rhs_controller>
       <!--edge_name>left</edge_name>
       <normal_stress_value>1</normal_stress_value-->
       <bodyforce_vector>1 0 0</bodyforce_vector>
   </unitflow_rhs_controller>


   <flowrate_calculation_edge_name>left</flowrate_calculation_edge_name>
   <report_header_reprint_frequency>30</report_header_reprint_frequency>

   <LowResolution_step>
      <max_iteration>600</max_iteration>
      <reports_frequency>50</reports_frequency>   

      <SteadyAnalyser>
	     <n_points_to_monitor>10</n_points_to_monitor>
         <normalized_deviation_limit>.001</normalized_deviation_limit>
      </SteadyAnalyser>

      <Secant>
         <max_iter>4</max_iter>
         <tolerance>1E-3</tolerance>
         <target>-1.</target>
         <initial_point>0 0</initial_point>
         <next_input>3.</next_input>
      </Secant>
   </LowResolution_step>


   <HighResolution_step>
      <max_iteration>0</max_iteration>
      <flowrate_convergence_limit>1E-5</flowrate_convergence_limit>

      <AugmentedLag>
         <reports_frequency>50</reports_frequency>
         <convergence_limit>1E-5</convergence_limit>
         <max_iteration>1000</max_iteration>
         <min_iteration>500</min_iteration>
      </AugmentedLag>
   </HighResolution_step>

   <Mesh>
      <name>encap</name>
      <type>symx droplet</type>
      <bubble_length>.8</bubble_length>
      <bubble_width>.1</bubble_width>
      <channel_width>1</channel_width>
      <channel_length>2</channel_length>
      <use_fineMesh_on_wall>es</use_fineMesh_on_wall>
      <hwall>.03</hwall>
      
      <ParametricCurve_mesh>
         <max_dTheta>.1</max_dTheta>
         <max_ds>.1</max_ds>
      </ParametricCurve_mesh>
      <command_line_args>-hmax .1</command_line_args>
      <plot_mesh_args>no</plot_mesh_args>
   </Mesh>

    <Adaptation>
        <cycles>3</cycles>
        <hmin>.0005</hmin>
        <hmax>.1</hmax>
        <hcoef>2 1</hcoef>
        <ratio>1</ratio>
        <err>4E-5</err>
        <errg>1e-3</errg>
        <additional>-AbsError</additional>
        <n_vertices_max>20000</n_vertices_max>
    </Adaptation>    
</data>
